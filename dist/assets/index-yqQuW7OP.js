(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function L(r,e="{{",t="}}"){let n=[];try{n=r.split(e).slice(1).map(i=>i.split(t)[0])}catch{}return n||[]}function V(r){return r.toUpperCase()!=r.toLowerCase()}function I(r,e="{{",t=[]){let n=r.indexOf(e),i=r;return n>-1?(t.push(n),i=i.split(""),i[n]="*",i[n+1]="*",i=i.join(""),I(i,e,t)):t}const F=function(r,e=[]){const t=L(r);for(let n of t){const i=n.split("this.").map(o=>o.replaceAll(" ","")).filter(o=>o.length>0);for(let o of i){let s=o.split(""),c=!1;for(let l=0;l<s.length;l++){const u=s[l];if(!V(u)){if(u=="."||u=="["||u=="]")continue;if(isNaN(u)){const f=s.slice(0,l).join("");e.indexOf(f)==-1&&e.push(f),c=!0;break}else continue}}if(!c){const l=o.trim();e.indexOf(l)==-1&&e.push(l)}}}return[...new Set(e)]},G=function(r){let e=r.innerHTML,t=L(e);for(let n of t){const i="{{"+n+"}}",o="{{"+n.replaceAll(" ","")+"}}";e=e.replaceAll(i,o)}try{r.innerHTML=e}catch{const i=document.createElement("div");i.innerHTML=e;const o=document.createElement("template");o.setAttribute("id",r.id),r.replaceWith(o),o.appendChild(i),r=i}return r},K=function(r,e,t,n){let i=r,o=r.charAt(e+t.length),s=r.charAt(e-1),c=e==0||!V(s)&&s!=".",l=e+t.length>r.length||!V(o);if(c&&l){i=r.split("");let u=r.slice(0,e),f=r.slice(e+t.length);i=u+n+f}return i},z=function(r,e=[],t=[]){let n=[];n=L(r);for(let i of n){let o=i;for(let s of t){let c=I(i,s);if(c.length>0){c.reverse();for(let l of c)o=K(o,l,s,"this.parent."+s)}}r=r.replaceAll("{{"+i+"}}","{{"+o+"}}")}r=r=="string"?r:r.innerHTML,n=L(r);for(let i of n){let o=i;for(let s of e){let c=I(i,s);if(c.length>0){c.reverse();for(let l of c)o=K(o,l,s,"this."+s)}}r=r.replaceAll("{{"+i+"}}","{{"+o+"}}")}return r},d={};class J{constructor(e,t=["variant","text","object","list","objectList","color","colors"]){if(this.__id="template-"+e,this.__scope=t||[],this.__set=!1,d.hasOwnProperty(this.__id))return d[this.__id];this.__original=document.querySelector("#"+this.__id),d[this.__id]=this}setup(){return d[this.__id].__set||(d[this.__id].__set=!0,d[this.__id].__template=document.createElement("template"),d[this.__id].__cleanedUpInnerHTML=G(this.__original),d[this.__id].__cleanedUpInnerHTML=z(d[this.__id].__original,d[this.__id].__scope),d[this.__id].__placeholder=document.createElement("div"),d[this.__id].__placeholder.innerHTML=d[this.__id].__cleanedUpInnerHTML,d[this.__id].__template.content.appendChild(d[this.__id].__placeholder),d[this.__id].__template.setAttribute("id",d[this.__id].__id),document.querySelector("#"+d[this.__id].__id).replaceWith(d[this.__id].__template)),d[this.__id]}}function R(r,e,t){return e=B(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function B(r){var e=Q(r,"string");return typeof e=="symbol"?e:String(e)}function Q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class T{constructor(){if(T.instance)return T.instance;T.instance=this}static getName(e){return e.replaceAll("../","")}static file(e){}static template(e){let t=this.getName(e),n=this.templates[t];return n||(this.templates[t]=new Promise(async i=>{const s=new J(t).setup();i(s.__template.content.cloneNode(!0).firstElementChild)}),this.templates[t])}}R(T,"instance",void 0);R(T,"templates",{});R(T,"files",{});function H(r,e,t){return e=X(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function X(r){var e=Y(r,"string");return typeof e=="symbol"?e:String(e)}function Y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Z{constructor(e,t){return this._preproxy=new WeakMap,this._handler=t,this.proxify(e,[])}makeHandler(e){let t=this;return{get(n,i,o){return t._handler.get?t._handler.get(n,[...e,i],o):n[i]},set(n,i,o,s){return typeof o=="object"&&(o=t.proxify(o,[...e,i])),n[i]=o,t._handler.set&&t._handler.set(n,[...e,i],o,s),!0},deleteProperty(n,i){if(Reflect.has(n,i)){t.unproxy(n,i);let o=Reflect.deleteProperty(n,i);return o&&t._handler.deleteProperty&&t._handler.deleteProperty(n,[...e,i]),o}return!1}}}unproxy(e,t){this._preproxy.has(e[t])&&(e[t]=this._preproxy.get(e[t]),this._preproxy.delete(e[t]));for(let n of Object.keys(e[t]))typeof e[t][n]=="object"&&this.unproxy(e[t],n)}proxify(e,t){for(let i of Object.keys(e))typeof e[i]=="object"&&(e[i]=this.proxify(e[i],[...t,i]));let n=new Proxy(e,this.makeHandler(t));return this._preproxy.set(n,e),n}}const k=(r=[])=>(Array.isArray(r)&&(r=r.join(".")),r=r.replaceAll("[",".").replaceAll("]",".").replaceAll("..",".").trim(),r.endsWith(".")&&(r=r.slice(0,-1)),r);class ee{constructor(){H(this,"events",{}),H(this,"prevValues",{}),H(this,"trackTimeout",void 0)}subscribe(e,t){return e=k(e),this.events[e]||(this.events[e]=[],this.prevValues[e]=void 0),this.events[e].push(t),(()=>{let i=!0;return{event:e,callback:t,render:()=>{if(i&&this.events[e])for(let o of this.events[e])o()},unsubscribe:()=>{i&&(i=!1,this.events[e]&&(this.events[e]=this.events[e].filter(o=>o!==t)))}}})()}publish(e,t){this.events[e]?this.prevValues[e]!=t?(this.prevValues[e]=t,this.events[e].forEach(n=>n(t))):console.log("data didnt change:",e):console.log("no events subscribed yet:",e)}unsubscribe(e){}track(){clearTimeout(this.trackTimeout),this.trackTimeout=setTimeout(()=>{console.log("---------------------------"),console.log("Subscription tracking".toUpperCase()),console.log("---------------------------");let e=0;for(let t of Object.keys(this.events)){let n=this.events[t].length;console.log("Sub:",t,n),e+=n}console.log(""),console.log("TOTAL: ",e+" active subscriptions"),console.log("-------------------------------------")},100)}}const te=function(r){const e=new ee;return r=new Z(r,{set(i,o,s,c){try{let l=k(o),u=typeof i[l];return l.indexOf("__")==0||(u!=="object"||Array.isArray(i[l]))&&e.publish(k(o),s),!0}catch(l){console.warn(l),console.log(o,k(o),s)}},deleteProperty(i,o){delete e.events[k(o)]},getPath(i,o){console.log("getPath",o.split("."),i)}}),[r,function(i,o){return e.subscribe(k(i),o)},function(){for(let i of Object.keys(e.events))e.publish(i)},e]},re=function(r={}){let[e,t,n]=te(r);return{scope:e,connect:t,render:n}},ne=function(r){return r.replaceAll("this.","").replaceAll("[",".").replaceAll("]",".").replaceAll("..",".").trim().split(".").slice(0).map(e=>(e[0]=="."&&(e=e.slice(1)),e.endsWith(".")&&(e=e.slice(0,-1)),e)).filter(e=>e.length>0)},ie=function(r,e,t){let n=typeof t;["boolean","number"].indexOf(n)==-1&&(t="'"+t+"'"),t!==N(r,e)&&Function("return `${this."+e+"="+t+"}`").call(r)},N=function(r,e){try{return Function("return this."+e).call(r)}catch{return Function("return `${this."+e+"}`").call(r)}};function oe(r,e,t){return e=se(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function se(r){var e=ce(r,"string");return typeof e=="symbol"?e:String(e)}function ce(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class w{static text(e,t,n,i){const o=function(s){const c=w.evaluate(e,i);n.textContent=c};return e.connect(t,o),o}static attribute(e,t,n,i,o){const s=function(c){const l=w.evaluate(e,i);n.setAttribute(o,l)};return e.connect(t,s),s}static model(e,t,n,i){let o=n.nodeName=="SELECT"?"select":n.getAttribute("type")||"text";const s=C[o](e,n,i,t),c=function(){s()};return e.connect(t,c),c}static evaluate(e,t,n="text"){try{let s=Function("return "+t).call(e.scope);return n=="boolean"?["true",!0].indexOf(s)>-1?s=!0:s=!1:n=="number"&&(s=Number(s)),s}catch{return t}}}oe(w,"lastRender",Date.now());const le=function(r,e){let t=e;Array.isArray(t)||(t=ne(t));try{let n=r;for(let i of t)n[i]&&(n=n[i]);return{success:!0,value:n,path:t}}catch{return{success:!1,value:void 0,path:t}}},ae=function(r,e,t){let{success:n,value:i,path:o}=le(r.scope,e);if((n||i==null)&&i!==t){const s=`\`\${this.${e} = '`+t+"'}`";w.evaluate(r,s)}};class C{static update(e,t,n){ae(e,t,n)}static connect(e,t,n,i,o){let s="value",c="keyup",l="text",u=function(h){return h.target.value};e==="checkbox"&&(s="checked",c="change",l="boolean",u=function(h){return h.currentTarget.checked}),e==="number"&&(l="number");let f=function(){let h=w.evaluate(t,i,l);e=="checkbox"?["true",!0].indexOf(h)>-1?n.setAttribute(s,!0):n.removeAttribute(s):n.setAttribute(s,h)};return n.addEventListener(c,function(h){C.update(t,o,u(h))}),f}static text(e,t,n,i){return C.connect("text",e,t,n,i)}static number(e,t,n,i){return C.connect("number",e,t,n,i)}static checkbox(e,t,n,i){return C.connect("checkbox",e,t,n,i)}static select(e,t,n,i){const o=function(u,f){[...u.querySelectorAll("option")].forEach(h=>{f==h.value?h.setAttribute("selected",!0):h.removeAttribute("selected")})},s=function(u){[...u.querySelectorAll("option")].forEach(f=>{f.__didInitialize=f.__didInitialize||[],f.__didInitialize.push(()=>{o(u,N(e.scope,i))})})},c=function(u){const f=t.getAttribute("value");u!=f&&o(t,u)};let l=N(e.scope,i)||void 0;return t.addEventListener("change",u=>{u.target.value!==l&&(l=u.target.value,ie(e.scope,i,u.target.value))}),s(t),o(t,N(e.scope,i)),c}}const ue=function(r){if(r.__setup.templateConnected)return;const e=r.reactiveProps.map;for(let o of Object.keys(e)){const s=e[o];for(let c of s)c.setup(r)}const t=r.actions.map;for(let o of Object.keys(t))for(let s of t[o])s.node.removeAttribute(o),s.setup(r);let n=r.operations.map.for;for(let o of n)o.setup(r);let i=r.operations.map.if;for(let o of i)o.setup(r);r.__setup.templateConnected=!0};function E(r,e,t){return e=fe(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function fe(r){var e=pe(r,"string");return typeof e=="symbol"?e:String(e)}function pe(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var he=function(r){return Array.prototype.map.call(r,function(e){return{att:e.name,value:e.value,reactive:e.value.indexOf("{{")>-1,action:e.name.indexOf("@")>-1,model:e.name.indexOf("model")==0}})};class de{constructor(){E(this,"map",{})}track(e,t={}){this.map.hasOwnProperty(e)||(this.map[e]=[]),delete t.setup,this.map[e].push({node:t.node,type:t.type,value:t.value,query:t.query,connected:!1,subscriptions:[],connect:function(n){},setup:function(n){if(this.connected)return this.subscriptions;this.subscriptions=this.connect(n)||[],this.connected=!0},...t})}}class me{constructor(){E(this,"map",{})}track(e,t={}){this.map.hasOwnProperty(e)||(this.map[e]=[]),delete t.setup,this.map[e].push({node:t.node,eventName:t.eventName,value:t.value,functionName:t.query,argumentList:[],connected:!1,subscriptions:[],connect:function(n){},setup:function(n){this.connected||(this.connected=!0,this.connect(n))},...t})}}class be{onDidConnect(){this.map.for.forEach(e=>{console.log(e),e.callback()}),this.map.if.forEach(e=>{e.callback()})}constructor(){E(this,"stack",{if:[],for:[]}),E(this,"map",{if:[],for:[]})}feed(e){this.stack.if[this.stack.if.length-1]&&this.stack.if[this.stack.if.length-1].nodes.push(e),this.stack.for[this.stack.for.length-1]&&this.stack.for[this.stack.for.length-1].nodes.push(e)}track(e,t={}){if(e=="@if")this.stack.if.push({prop:e,nodes:[]});else if(e=="@endif")try{let n=this.stack.if.pop(),i=n.nodes[0],o=n.nodes[n.nodes.length-1],s=n.nodes.slice(1,n.nodes.length-2),c={start:i,end:o,content:s,query:"this.condition",value:"this.condition",connected:!1,callback:function(){},connect:function(l){const u=document.createComment("if placeholder ");u.content=s,i.replaceWith(u),o.remove();for(let h of s)h.remove();let f=function(){if(["true",!0].indexOf(l.scope.checked)>-1)for(let g of u.content)u.after(g);else for(let g of u.content)g.remove()};l.connect("checked",f),this.callback=f},setup:function(l){this.connected||(this.connected=!0,this.connect(l))}};this.map.if.push(c)}catch{}else if(e=="@for")this.stack.for.push({prop:e,nodes:[]});else if(e=="@endfor")try{let n=this.stack.for.length,i=this.stack.for.pop(),o={$index:0};for(let f=1;f<n;f++)o["$index"+f]=0;let s=i.nodes[0],c=i.nodes[i.nodes.length-1],l=i.nodes.slice(1,i.nodes.length-2);l=l.map(f=>(f.dataset.elIndex=JSON.stringify(o),f));let u={start:s,end:c,content:l,query:"this.colors.length",value:"this.colors.length",stack:[],connected:!1,callback:function(){},connect:function(f){const h=document.createElement("template"),g=document.createComment("for placeholder ");let M="";g.content=l,g.stack=[],s.replaceWith(g),c.remove();for(let _ of l)h.content.appendChild(_);document.head.appendChild(h),h.setAttribute("id","template-for-loop"),console.log(h);let a=async function(){let _=f.scope.colors.length;for(let p=0;p<_;p++){let A=await T.template("for-loop",this.__props);console.log(p);let m=A.cloneNode(!0);m.innerHTML=m.innerHTML.replaceAll("${d","{{this.colors[$index]"),m.innerHTML=m.innerHTML.replaceAll("${c","{{this.colors[$index]").replaceAll("[$index","["+p).replaceAll("{$index","{"+p).replaceAll("`","").replaceAll("${","{{").replaceAll("}","}}").replaceAll("$index",p);let{props:y,actions:x,operations:v}=W(m);const b=y.map;for(let O of Object.keys(b)){const S=b[O];for(let q of S)q.setup(f)}x=x.map;for(let O of Object.keys(x))for(let S of x[O])S.node.removeAttribute(O),S.setup(f);g.after(m.firstElementChild)}};f.connect("colors.length",a),this.callback=a},setup:function(f){this.connected||(this.connected=!0,this.connect(f))}};this.map.for.push(u)}catch{}}}const W=function(r){const e=new de,t=new me,n=new be;var i=function(o,s){return Array.prototype.map.call(o.childNodes,function(c){var g,M;var l={content:c.childNodes&&c.childNodes.length>0?null:c.textContent,atts:c.nodeType!==1?[]:he(c.attributes),type:c.nodeType===3?"text":c.nodeType===8?"comment":c.tagName.toLowerCase(),node:c};for(let a of["if","for"]){let _=((g=c==null?void 0:c.data)==null?void 0:g.indexOf("@"+a))??-1,p=((M=c==null?void 0:c.data)==null?void 0:M.indexOf("@end"+a))??-1;_>-1&&n.track("@"+a),p>-1&&(n.feed(c),n.track("@end"+a))}n.feed(c),l.reactive=l.content&&l.content.indexOf("{{")>-1&&!l.operation;let u=l.atts.filter(a=>a.reactive);if(u.length>0)for(let a of u){let _=a.att,p=a.value;for(let A of L(a.value)){let m=F("{{"+A.trim()+"}}");for(let y of m){let x=y,v=a.value;v=v.replaceAll("{{"+A+"}}","{{"+A.replaceAll(x,y)+"}}"),v="`"+v.replaceAll("{{","${").replaceAll("}}","}")+"`",e.track(y,{node:c,type:"attribute",value:p,query:v,connect:function(b){let O;_=="model"?O=w.model(b,y,c,v):O=w.attribute(b,y,c,v,_),O()}})}}}if(l.atts.filter(a=>a.model).length>0){let a=c.getAttribute("model"),_=a.indexOf("this.")>-1?a:"this."+a,p="`${"+_+"}`";e.track(a,{node:c,type:"model",value:_,query:p,connect:function(A){w.model(A,a,c,p)()}})}if(l.reactive)for(let a of L(l.content)){let _=F("{{"+a.trim()+"}}");for(let p of _){let A=p,m=l.content;m=m.replaceAll("{{"+a+"}}","{{"+a.replaceAll(A,p)+"}}"),m="`"+m.replaceAll("{{","${").replaceAll("}}","}")+"`",e.track(p,{node:c,type:"text",value:l.content,query:m,connect:function(y){w.text(y,p,c,m)()}})}}let h=l.atts.filter(a=>a.action);if(h.length>0)for(let a of h){a=a.att;const _=c.hasOwnProperty(a)?"native":"custom";let p=a.replaceAll("@","");const A=c.getAttribute(a),m=c.getAttribute(a).trim().replaceAll(" ",""),y=m.split("(").map(b=>b.trim()).filter(b=>b.length>0),x=y[0];let v=[];y.length>1&&(v=y[1].split(")").map(b=>b.trim()).filter(b=>b.length>0)[0].split(",")),p.indexOf("on")==0&&typeof c[p.slice(2)]=="function"&&(p=p.slice(2)),t.track(a,{node:c,type:_,value:A,eventName:p,query:m,actionName:x,args:v,connect:function(b){c.addEventListener(p,function(O){const S=b.scope;S.$event=O;let q=JSON.parse(c.getAttribute("el-index")||JSON.stringify({$index:0}));for(let[P,U]of Object.entries(q))S[P]=U;let D=v.map(P=>S.hasOwnProperty(P)?S[P]:isNaN(P)?["'",'"',"`"].indexOf(P.trim().charAt(0))>-1?P.trim().slice(1,P.trim().length-1):P:Number(P));b[x](...D)})}})}return l.isSVG=s||l.type==="svg",l.children=i(c,l.isSVG),l})};return console.log(n),i(r),{props:e,actions:t,operations:n}};let j=null;function _e(){return j===null&&(j=Array.from(document.styleSheets).map(r=>{const e=new CSSStyleSheet,t=Array.from(r.cssRules).map(n=>n.cssText).join(" ");return e.replaceSync(t),e})),j}function ye(r){r.adoptedStyleSheets.push(..._e())}function $(r,e,t){return e=ve(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ve(r){var e=ge(r,"string");return typeof e=="symbol"?e:String(e)}function ge(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Ae extends HTMLElement{constructor(){super(),$(this,"__setup",{templateConnected:!1,propTracked:!1}),$(this,"checked",!0),$(this,"text","text property"),$(this,"object",{key:"object value"}),$(this,"list",["list id: 0"]),$(this,"objectList",[{item:"object list item id: 0"}]),$(this,"color","yellow"),$(this,"colors",["green","red","yellow"]);const e=this.attachShadow({mode:"open"});this.__shadowRoot=e,ye(this.__shadowRoot)}connectScope(){const e={};this.__props=Object.getOwnPropertyNames(this).filter(s=>s.indexOf("_")!=0&&typeof s!="function"),this.__props.forEach(s=>{e[s]=this.getAttribute(s)||this[s],this.setAttribute(s,e[s])});const{scope:t,connect:n,render:i,pubsub:o}=re(e);this.scope=t,this.connect=n}async connectTemplate(){this.__template=await T.template("my-button",this.__props),this.__shadowRoot.appendChild(this.__template);const{props:e,actions:t,operations:n}=W(this.__template);this.reactiveProps=e,this.actions=t,this.operations=n,ue(this)}async connectedCallback(){this.__didConnect||(this.__didConnect=!0,this.connectScope(),await this.connectTemplate(),this.operations.onDidConnect()),this.render()}attributeChangedCallback(e,t,n){console.log("attributeChangedCallback",e,t,n)}render(){}fn(e,t,n,i,o){console.log("FN CALLED",{$event:e,$index:t,text:n,str:i,num:o})}customFn(){console.log("Custom FN CALLED")}}customElements.define("my-button",Ae);
